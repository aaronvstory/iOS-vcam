You are reviewing a set of changes to an iOS VCAM streaming server project (PowerShell launcher + docs).

Review for: (1) security (OWASP), (2) accessibility (WCAG), (3) 2025 best practices, (4) performance pitfalls, (5) platform compatibility.

OUTPUT REQUIREMENTS:
1) Start with a JSON array in a single fenced block (```json). Each item: {severity: 'CRITICAL|HIGH|MEDIUM|LOW', title, details, file, line, recommendation}.
2) Then provide a short human summary.

INPUT (diff/excerpts):

diff --git a/CLAUDE.md b/CLAUDE.md
index d71a43c..a69442f 100644
--- a/CLAUDE.md
+++ b/CLAUDE.md
@@ -242,10 +242,13 @@ User-facing wiki documentation lives in `docs/`:
 | `Installation.md` | Prerequisites and setup guide |
 | `Configuration.md` | SRS config profiles and parameters |
 | `Streaming-Guide.md` | WiFi/USB streaming howto |
 | `Troubleshooting.md` | Common issues and fixes |
 | `Advanced-Features.md` | SSH, debranding, Frida, architecture |
+| `iPhone-SSH-Quick-Reference.md` | SSH via USB (iproxy + plink) - device UDIDs, credentials |
+| `USB-Streaming-Debugging.md` | Comprehensive USB tunnel debugging guide |
+| `Post-Reboot-Checklist.md` | Recovery steps after iPhone reboot |
 
 **Maintenance Rules:**
 - When menu options change, update references in docs (e.g., "Option [3]")
 - When adding features, update relevant wiki page
 - Keep `Home.md` ToC in sync with actual pages
diff --git a/config/active/srs_ultimate_auto.conf b/config/active/srs_ultimate_auto.conf
index 6e4ce37..f16c171 100644
--- a/config/active/srs_ultimate_auto.conf
+++ b/config/active/srs_ultimate_auto.conf
@@ -164,10 +164,15 @@ vhost __defaultVhost__ {
 
 
 
 
 
+
+
+
+
+
 
 
 
 
 
diff --git a/docs/Post-Reboot-Checklist.md b/docs/Post-Reboot-Checklist.md
index 5a50b04..901a109 100644
--- a/docs/Post-Reboot-Checklist.md
+++ b/docs/Post-Reboot-Checklist.md
@@ -26,10 +26,13 @@ Write-Host "NEW Fingerprint: $fp"
 .\plink.exe -hostkey $fp -ssh -P 2222 -pw icemat root@localhost 'ifconfig lo0 alias 127.10.10.10 netmask 255.255.255.255; echo ALIAS_OK'
 
 # 6. Verify tunnel works
 .\plink.exe -v -hostkey $fp -ssh -batch -T -no-antispoof -R 127.10.10.10:80:127.0.0.1:80 -R 127.10.10.10:1935:127.0.0.1:1935 -P 2222 -pw icemat root@localhost 'echo TUNNEL_TEST; sleep 3' 2>&1 | Select-String "Remote port forwarding"
 # Should show "enabled" NOT "refused"
+
+# 7. Stabilize Media Subsystem (Fixes Camera/VNC crashes)
+.\plink.exe -hostkey $fp -ssh -P 2222 -pw icemat root@localhost 'killall -9 mediaserverd; echo MEDIA_STABILIZED'
 ```
 
 ## What Gets Lost After Reboot
 
 | Setting | Location | Persists? | Fix |
diff --git a/docs/USB-Streaming-Debugging.md b/docs/USB-Streaming-Debugging.md
index 69ab8dd..0bc586b 100644
--- a/docs/USB-Streaming-Debugging.md
+++ b/docs/USB-Streaming-Debugging.md
@@ -16,10 +16,11 @@ This document captures everything learned while debugging USB streaming issues.
 6. [sshd Configuration](#sshd-configuration)
 7. [Tunnel Verification](#tunnel-verification)
 8. [iOS App "Network Error"](#ios-app-network-error)
 9. [Process Management](#process-management)
 10. [Debugging Flowchart](#debugging-flowchart)
+11. [VNC Coexistence (TrollVNC + iOS-VCAM)](#vnc-coexistence-trollvnc--ios-vcam)
 
 ---
 
 ## Quick Diagnostic Commands
 
@@ -78,10 +79,73 @@ $fp = "<fingerprint from above>"
   Select-String "Remote port forwarding"
 ```
 
 **Expected**: `Remote port forwarding from 127.10.10.10:80 enabled` (NOT "refused")
 
+### 8. Check Process Command Lines (CRITICAL for multi-device)
+```powershell
+Get-CimInstance Win32_Process -Filter "Name='iproxy.exe' OR Name='plink.exe'" |
+  Select-Object Name,ProcessId,CommandLine | Format-List
+```
+
+**Expected for iproxy**: Must include `-u <UDID>` to target correct device
+**Expected for plink**: Must include `-R 127.10.10.10:80` and `-R 127.10.10.10:1935`
+
+---
+
+## ALL-IN-ONE Quick Test Script
+
+Copy-paste this entire block to diagnose USB streaming in one shot:
+
+```powershell
+# USB Streaming Quick Diagnostic - Run from project directory
+Write-Host "=== USB STREAMING DIAGNOSTIC ===" -ForegroundColor Cyan
+
+# 1. Check processes
+Write-Host "`n[1] PROCESSES:" -ForegroundColor Yellow
+Get-Process -Name plink,python,monibuca,iproxy -ErrorAction SilentlyContinue |
+  Select-Object Name,Id | Format-Table -AutoSize
+
+# 2. Check command lines (multi-device issue detection)
+Write-Host "[2] COMMAND LINES:" -ForegroundColor Yellow
+Get-CimInstance Win32_Process -Filter "Name='iproxy.exe' OR Name='plink.exe'" |
+  ForEach-Object { Write-Host "  $($_.Name) (PID $($_.ProcessId)): $($_.CommandLine)" }
+
+# 3. Get fingerprint
+Write-Host "`n[3] SSH FINGERPRINT:" -ForegroundColor Yellow
+$fpOut = (.\plink.exe -4 -ssh -batch -P 2222 -pw icemat root@127.0.0.1 exit 2>&1) | Out-String
+if ($fpOut -match 'SHA256:[A-Za-z0-9+/=]+') {
+  $fp = $Matches[0]
+  Write-Host "  $fp" -ForegroundColor Green
+} else {
+  Write-Host "  FAILED to get fingerprint!" -ForegroundColor Red
+  return
+}
+
+# 4. Check iPhone listeners (THE KEY TEST)
+Write-Host "`n[4] iPHONE LISTENERS (must show 80 + 1935):" -ForegroundColor Yellow
+$listeners = (.\plink.exe -4 -hostkey $fp -ssh -batch -P 2222 -pw icemat root@127.0.0.1 'netstat -an | grep "127.10.10.10.*LISTEN"' 2>&1) | Out-String
+if ($listeners -match '127\.10\.10\.10\.(80|1935)') {
+  Write-Host $listeners -ForegroundColor Green
+} else {
+  Write-Host "  ‚ùå NO LISTENERS on 127.10.10.10 - TUNNEL NOT WORKING!" -ForegroundColor Red
+}
+
+# 5. Check which device we're connected to
+Write-Host "[5] CONNECTED DEVICE:" -ForegroundColor Yellow
+$device = (.\plink.exe -4 -hostkey $fp -ssh -batch -P 2222 -pw icemat root@127.0.0.1 'uname -n' 2>&1) | Out-String
+Write-Host "  $($device.Trim())" -ForegroundColor Cyan
+
+Write-Host "`n=== END DIAGNOSTIC ===" -ForegroundColor Cyan
+```
+
+**Key things to verify:**
+1. ‚úÖ iproxy command line includes `-u <UDID>`
+2. ‚úÖ plink command line includes `-R 127.10.10.10:80` and `-R 127.10.10.10:1935`
+3. ‚úÖ iPhone listeners show BOTH ports 80 and 1935 on 127.10.10.10
+4. ‚úÖ Connected device hostname matches expected (e.g., "iPhoneSE2")
+
 ---
 
 ## Common Error Messages & Solutions
 
 ### "Host key not in manually configured list"
@@ -457,10 +521,122 @@ Option [U] automatically:
 - Probes fingerprint
 - Checks/fixes sshd config
 - Sets up loopback alias
 - Verifies tunnel acceptance BEFORE starting
 - Starts the actual tunnel only if everything passes
+- **Verifies listeners on iPhone** (not just plink alive)
+
+### 7. Multiple Devices = iproxy Targeting Issue
+With multiple iOS devices connected, iproxy can forward to the **wrong device** unless you specify the UDID:
+```powershell
+# ‚ùå BAD - ambiguous with multiple devices
+iproxy.exe 2222 22
+
+# ‚úÖ GOOD - deterministic
+iproxy.exe -u <UDID> 2222 22
+```
+
+**Symptoms**: "SSH tunnel OK" but iOS app shows "Network Error" because:
+- Tunnel is bound on iPhone 8
+- You're testing on SE2
+- SE2 has no listeners on 127.10.10.10
+
+**Quick fix**: Unplug other devices, or ensure launcher uses `-u` flag.
+
+### 8. "plink Alive" ‚â† "Tunnel Working"
+Plink can be running but with stale/refused tunnels. Always verify listeners:
+```powershell
+# Run ON THE PHONE to verify
+netstat -an | grep '127.10.10.10.*LISTEN'
+```
+Must show BOTH :80 and :1935. The launcher now does this automatically.
+
+### 9. Keep-Alive Command Must Be Quote-Free
+When starting plink via `Start-Process -ArgumentList`, complex shell commands with quotes get mangled.
+
+```powershell
+# ‚ùå FAILS via Start-Process (quotes get stripped)
+'sh -c "while :; do sleep 3600; done"'
+
+# ‚úÖ WORKS (no quotes, no shell)
+'sleep 31536000'   # 1 year
+'cat'              # Also works if stdin stays open
+```
+
+If plink "verification passes but process dies immediately", this is the cause.
+
+### 10. Race Condition: Verification ‚Üí Real Tunnel
+If verification binds the SAME ports (80/1935) as the real tunnel, they can conflict due to TCP TIME_WAIT state.
+
+**Symptom**: Verification says "‚úÖ Tunnel ports accepted" but plink log shows "refused"
+
+**Fix**: Use DIFFERENT test ports for verification (18080/11935 instead of 80/1935):
+```powershell
+# Verification uses test ports - doesn't conflict with real tunnel
+'-R', '127.10.10.10:18080:127.0.0.1:80',   # Test port, not 80
+'-R', '127.10.10.10:11935:127.0.0.1:1935', # Test port, not 1935
+
+# Real tunnel uses actual ports
+'-R', '127.10.10.10:80:127.0.0.1:80',
+'-R', '127.10.10.10:1935:127.0.0.1:1935',
+```
+This tests the same mechanism (SSH port forwarding to 127.10.10.10) without port conflicts.
+
+---
+
+## VNC Coexistence (TrollVNC + iOS-VCAM)
+
+### The Problem
+
+Both TrollVNC and iOS-VCAM use `iproxy.exe` for USB port forwarding:
+- **VNC**: Ports 5901, 5902 for screen mirroring
+- **VCAM**: Port 2222 for SSH tunnel
+
+When either system does cleanup, it could kill the other's iproxy instance, breaking the connection.
+
+### The Solution (Implemented 2025-12-31)
+
+Both scripts now use **port-based process identification** to only kill their own iproxy instances:
+
+- **TrollVNC** (`C:\iProxy\TrollVNC_Manager.bat`): Only kills iproxy with "5901" or "5902" in command line
+- **iOS-VCAM** (`iOS-VCAM-Launcher.ps1`): Only kills iproxy with "2222" in command line
+
+### Running Both Simultaneously
+
+1. Start VNC first (TrollVNC Manager)
+2. Start VCAM USB streaming (Option U)
+3. Both can coexist without interference
+
+### Check All iproxy Instances
+```powershell
+wmic process where "name='iproxy.exe'" get processid,commandline
+```
+
+**Expected output when both running:**
+```
+PID xxx: iproxy -u <UDID> 5901 5901  (VNC iPhone 8+)
+PID yyy: iproxy -u <UDID> 2222 22    (VCAM SSH)
+PID zzz: iproxy -u <UDID> 5902 5901  (VNC SE2)
+```
+
+### USB Bandwidth Considerations
+
+Both VNC and VCAM are bandwidth-heavy. If you experience stuttering:
+
+1. **Reduce VNC quality**: Enable Performance Mode in TrollVNC (Option P)
+2. **Lower VCAM resolution**: Use 720p instead of 1080p
+3. **Use USB 3.0 port**: If available, use a blue USB port
+4. **Avoid simultaneous high activity**: Don't scroll rapidly on VNC while streaming
+
+### Troubleshooting
+
+| Symptom | Cause | Fix |
+|---------|-------|-----|
+| VNC freezes when VCAM starts | Old script killing all iproxy | Update TrollVNC_Manager.bat |
+| VNC crashes with Camera | Resource contention / iOS policy | See [VNC-Camera-Coexistence.md](VNC-Camera-Coexistence.md) |
+| VCAM tunnel dies when VNC restarts | Old script killing all iproxy | Already fixed in launcher |
+| Both stutter simultaneously | USB bandwidth saturation | Reduce quality on one or both |
 
 ---
 
 ## Related Documentation
 
@@ -472,9 +648,15 @@ Option [U] automatically:
 
 ## Version History
 
 | Date | Changes |
 |------|---------|
+| 2025-12-31 | Added VNC coexistence section - fixed mutual iproxy killing bug |
 | 2025-12-30 | Initial version after debugging session |
 | | Added IPv6 false positive fix |
 | | Added auto sshd config fix |
 | | Added fingerprint re-probe after sshd restart |
+| | Fixed iproxy UDID binding (multi-device support) |
+| | Added listener verification (not just plink alive check) |
+| | Fixed keep-alive command (sleep vs quoted sh -c) |
+| | Fixed race condition (2s delay after verification) |
+| | Added plink SSH logging for debugging |
diff --git a/iOS-VCAM-Launcher.ps1 b/iOS-VCAM-Launcher.ps1
index 0f809c0..9fb3f70 100644
--- a/iOS-VCAM-Launcher.ps1
+++ b/iOS-VCAM-Launcher.ps1
@@ -1329,17 +1329,18 @@ function Stop-UsbStreamingProcesses {
         Write-Host "  üßπ Stopping all USB streaming processes..." -ForegroundColor Yellow
     }
 
     $processesKilled = 0
 
-    # Kill iproxy processes
-    $iproxyProcs = Get-Process -Name "iproxy" -ErrorAction SilentlyContinue
+    # Kill only VCAM's iproxy (port 2222) - preserve VNC iproxy (5901/5902)
+    $iproxyProcs = Get-WmiObject Win32_Process -Filter "Name='iproxy.exe'" -ErrorAction SilentlyContinue |
+        Where-Object { $_.CommandLine -match '2222' }
     if ($iproxyProcs) {
         foreach ($proc in $iproxyProcs) {
             try {
-                if (-not $Silent) { Write-Host "  üî• Stopping iproxy (PID: $($proc.Id))" -ForegroundColor Red }
-                Stop-Process -Id $proc.Id -Force -ErrorAction SilentlyContinue
+                if (-not $Silent) { Write-Host "  üî• Stopping iproxy SSH (PID: $($proc.ProcessId))" -ForegroundColor Red }
+                Stop-Process -Id $proc.ProcessId -Force -ErrorAction SilentlyContinue
                 $processesKilled++
             } catch { }
         }
     }
 
@@ -1907,12 +1908,13 @@ function Start-MonibucaViaSshUsb {
     # STEP 6: Launch iproxy (USB SSH forwarding) - HIDDEN
     # ============================================================================
     Write-Host "[STEP 6/9] üöÄ Starting iproxy (USB ‚Üí SSH forwarding)..." -ForegroundColor Yellow
 
     # Run iproxy hidden - it just forwards ports, no user interaction needed
+    # CRITICAL: Use -u flag to bind to specific UDID (prevents wrong-device issues)
     $iproxyCommand = @"
-& "$iproxyPath" 2222 22 "$selectedUDID"
+& "$iproxyPath" -u "$selectedUDID" 2222 22
 "@
 
     Start-Process powershell -ArgumentList "-ExecutionPolicy", "Bypass", "-Command", $iproxyCommand -WindowStyle Hidden
 
     # Wait for iproxy process to start (USB forwarding doesn't show as TCP listener)
@@ -2177,15 +2179,16 @@ Write-Host 'Monibuca stopped. Press any key to close...' -ForegroundColor Yellow
         Add-Content -Path $script:UsbLogFile -Value "[$(Get-Date -Format 'HH:mm:ss')] iPhone alias warning: $aliasResult"
     }
 
     # STEP 9d: Verify tunnel will work BEFORE starting (verbose probe)
     # Uses -4 and 127.0.0.1 to avoid IPv6 "Connection refused" false positives
+    # CRITICAL: Use DIFFERENT test ports (18080/11935) to avoid race condition with real tunnel
     Write-Host "  üîç Verifying tunnel acceptance..." -ForegroundColor Gray
 
     $verifyArgs = @('-4', '-v', '-ssh', '-batch', '-T', '-no-antispoof',
-        '-R', '127.10.10.10:80:127.0.0.1:80',
-        '-R', '127.10.10.10:1935:127.0.0.1:1935',
+        '-R', '127.10.10.10:18080:127.0.0.1:80',
+        '-R', '127.10.10.10:11935:127.0.0.1:1935',
         '-P', '2222', '-pw', "$sshPassword", 'root@127.0.0.1', 'echo PROBE; exit')
     if ($hostKeyFp) { $verifyArgs = @('-hostkey', $hostKeyFp) + $verifyArgs }
 
     $verifyOut = (& "$plinkPath" $verifyArgs 2>&1) | Out-String
 
@@ -2204,11 +2207,11 @@ Write-Host 'Monibuca stopped. Press any key to close...' -ForegroundColor Yellow
         # Host key changed again - re-probe and retry
         Write-Host "  üîë Host key changed, re-probing..." -ForegroundColor Cyan
         $hostKeyFp = Get-SshFingerprint -PlinkExe $plinkPath -Password $sshPassword
         if ($hostKeyFp) {
             $verifyArgs = @('-hostkey', $hostKeyFp, '-4', '-v', '-ssh', '-batch', '-T', '-no-antispoof',
-                '-R', '127.10.10.10:80:127.0.0.1:80', '-R', '127.10.10.10:1935:127.0.0.1:1935',
+                '-R', '127.10.10.10:18080:127.0.0.1:80', '-R', '127.10.10.10:11935:127.0.0.1:1935',
                 '-P', '2222', '-pw', "$sshPassword", 'root@127.0.0.1', 'echo PROBE; exit')
             $verifyOut = (& "$plinkPath" $verifyArgs 2>&1) | Out-String
             if ($verifyOut -match 'Remote port forwarding from .* enabled') {
                 Write-Host "  ‚úÖ Tunnel ports accepted (after key refresh)" -ForegroundColor Green
             } elseif ($verifyOut -match 'Remote port forwarding from .* refused') {
@@ -2216,20 +2219,28 @@ Write-Host 'Monibuca stopped. Press any key to close...' -ForegroundColor Yellow
                 $allReady = $false
             }
         }
     }
 
-    # STEP 9e: Start the actual tunnel (keep-alive with 'cat')
+    # STEP 9e: Start the actual tunnel (keep-alive with sleep)
     # Uses -4 and 127.0.0.1 to force IPv4
     if ($allReady) {
         Write-Host "  üîó Starting SSH reverse tunnel..." -ForegroundColor Gray
 
+        # Create plink log for debugging if it dies (use same dir as UsbLogFile)
+        $plinkLogDir = Split-Path -Parent $script:UsbLogFile
+        if (-not $plinkLogDir) { $plinkLogDir = Join-Path $script:SRSHome "logs" }
+        if (-not (Test-Path $plinkLogDir)) { New-Item -ItemType Directory -Path $plinkLogDir -Force | Out-Null }
+        $plinkLogFile = Join-Path $plinkLogDir ("plink-tunnel-" + (Get-Date -Format "yyyy-MM-dd_HH-mm-ss") + ".log")
+
         $tunnelArgs = @(
             '-4', '-ssh', '-batch', '-T', '-no-antispoof',
+            '-sshlog', $plinkLogFile,
             '-R', '127.10.10.10:80:127.0.0.1:80',
             '-R', '127.10.10.10:1935:127.0.0.1:1935',
-            '-P', '2222', '-pw', "$sshPassword", 'root@127.0.0.1', 'cat'
+            '-P', '2222', '-pw', "$sshPassword", 'root@127.0.0.1',
+            'sleep 31536000'  # 1 year - no quotes/shell escaping needed
         )
         if ($hostKeyFp) { $tunnelArgs = @('-hostkey', $hostKeyFp) + $tunnelArgs }
 
         Start-Process -WindowStyle Hidden -FilePath "$plinkPath" -ArgumentList $tunnelArgs
 
@@ -2242,10 +2253,30 @@ Write-Host 'Monibuca stopped. Press any key to close...' -ForegroundColor Yellow
             Start-Sleep -Seconds 2
             $plinkStillAlive = Get-Process -Name "plink" -ErrorAction SilentlyContinue
             if ($plinkStillAlive) {
                 Write-Host "  ‚úÖ SSH tunnel running (PID: $($plinkStillAlive.Id -join ', '))" -ForegroundColor Green
                 Add-Content -Path $script:UsbLogFile -Value "[$(Get-Date -Format 'HH:mm:ss')] STEP9: SSH tunnel OK - plink stable"
+
+                # CRITICAL: Verify tunnels are actually bound on iPhone (not just plink alive)
+                Write-Host "  üîç Verifying tunnel ports bound on iPhone..." -ForegroundColor Gray
+                $checkListeners = 'netstat -an | grep -E "127\.10\.10\.10\.(80|1935).*LISTEN" || echo NO_LISTENERS'
+                $listenerArgs = @('-4', '-ssh', '-batch', '-T', '-no-antispoof', '-P', '2222', '-pw', $sshPassword, 'root@127.0.0.1', $checkListeners)
+                if ($hostKeyFp) { $listenerArgs = @('-hostkey', $hostKeyFp) + $listenerArgs }
+                $listenerCheck = (& $plinkPath $listenerArgs 2>&1) | Out-String
+
+                if ($listenerCheck -match 'NO_LISTENERS') {
+                    Write-Host "  ‚ùå Tunnel NOT listening on iPhone - ports not bound!" -ForegroundColor Red
+                    Write-Host "     Likely cause: iproxy on wrong device or sshd config issue" -ForegroundColor Yellow
+                    Add-Content -Path $script:UsbLogFile -Value "[$(Get-Date -Format 'HH:mm:ss')] STEP9: TUNNEL NOT BOUND - listeners not found on 127.10.10.10"
+                    $allReady = $false
+                } elseif ($listenerCheck -match '127\.10\.10\.10\.(80|1935)') {
+                    Write-Host "  ‚úÖ Tunnel ports verified on iPhone (80 + 1935)" -ForegroundColor Green
+                    Add-Content -Path $script:UsbLogFile -Value "[$(Get-Date -Format 'HH:mm:ss')] STEP9: Tunnel ports VERIFIED listening on iPhone"
+                } else {
+                    Write-Host "  ‚ö†Ô∏è Could not verify tunnel listeners (check manually)" -ForegroundColor Yellow
+                    Add-Content -Path $script:UsbLogFile -Value "[$(Get-Date -Format 'HH:mm:ss')] STEP9: Listener check inconclusive: $listenerCheck"
+                }
             } else {
                 Write-Host "  ‚ö†Ô∏è SSH tunnel died shortly after starting!" -ForegroundColor Yellow
                 Add-Content -Path $script:UsbLogFile -Value "[$(Get-Date -Format 'HH:mm:ss')] STEP9: SSH tunnel DIED"
                 $allReady = $false
             }
diff --git a/shutdown.bat b/shutdown.bat
index e94355f..6cbed83 100644
--- a/shutdown.bat
+++ b/shutdown.bat
@@ -1 +1 @@
-taskkill /pid 83236  -t  -f
\ No newline at end of file
+taskkill /pid 117600  -t  -f
\ No newline at end of file
